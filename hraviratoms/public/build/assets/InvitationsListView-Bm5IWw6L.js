import{r as m,o as C,c as o,a as t,e as c,F as $,b as D,t as r,d as a}from"./app-BFZ9Kyn7.js";const L={class:"mb-4 flex items-center justify-between gap-2"},S={key:0,class:"rounded-2xl border bg-white p-4 text-sm text-slate-500 shadow-sm"},E={key:1,class:"rounded-2xl border bg-white p-4 text-sm text-slate-500 shadow-sm"},A={key:2,class:"overflow-hidden rounded-2xl border bg-white shadow-sm"},T={class:"min-w-full text-left text-sm"},j={class:"px-4 py-3 align-top"},F={class:"font-medium text-slate-900"},I={class:"text-xs text-slate-500"},N={class:"px-4 py-3 align-top text-xs text-slate-600"},P={class:"px-4 py-3 align-top text-xs text-slate-600"},V={class:"px-4 py-3 align-top text-xs text-slate-600"},B={key:0},O={key:1},R={class:"px-4 py-3 align-top text-xs"},q={key:0,class:"inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] font-medium text-emerald-700"},M={key:1,class:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-[11px] font-medium text-slate-500"},U={class:"px-4 py-3 align-top text-xs"},K={class:"max-w-[200px] truncate text-slate-600"},X=["onClick"],z={class:"px-4 py-3 align-top text-right text-xs"},G={class:"flex flex-wrap justify-end gap-2"},H=["href"],J=["onClick"],Q=["onClick"],W=["onClick"],Y={key:3,class:"mt-3 text-xs text-red-500"},et={__name:"InvitationsListView",setup(Z){var _,y;const p=((_=document.querySelector('meta[name="superadmin"]'))==null?void 0:_.getAttribute("content"))==="1",l=m([]),u=m(!0),i=m(""),b=((y=document.querySelector('meta[name="csrf-token"]'))==null?void 0:y.getAttribute("content"))||"",h=e=>`${window.location.origin}/i/${e.slug}`,g=async e=>{const n=h(e);try{await navigator.clipboard.writeText(n),alert("Link copied!")}catch{prompt("Copy this link:",n)}},k=e=>{if(!e)return"";try{return new Date(e).toLocaleDateString("ru-RU")}catch{return e}},v=async()=>{u.value=!0,i.value="";try{const e=await fetch("/api/invitations",{headers:{Accept:"application/json"}});if(e.status===403){l.value=[];return}if(!e.ok){i.value="Не удалось загрузить приглашения",l.value=[];return}l.value=await e.json()}catch{i.value="Ошибка при загрузке приглашений",l.value=[]}finally{u.value=!1}},w=async e=>{if(confirm(`Удалить приглашение для пары "${e.bride_name} & ${e.groom_name}"?`))try{if(!(await fetch(`/api/invitations/${e.id}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":b,Accept:"application/json"}})).ok){alert("Failed to delete invitation");return}l.value=l.value.filter(d=>d.id!==e.id),alert("Invitation deleted")}catch{alert("Error deleting invitation")}};return C(v),(e,n)=>(a(),o("section",null,[t("div",L,[n[1]||(n[1]=t("div",null,[t("h1",{class:"text-2xl font-semibold"},"My invitations"),t("p",{class:"mt-1 text-sm text-slate-600"}," Здесь отображаются все созданные приглашения с публичными ссылками. ")],-1)),t("button",{class:"btn-primary",onClick:n[0]||(n[0]=s=>e.$router.push({name:"templates.index"}))}," + New invitation ")]),u.value?(a(),o("div",S," Loading invitations... ")):l.value.length?(a(),o("div",A,[t("table",T,[n[2]||(n[2]=t("thead",{class:"bg-slate-50 text-xs uppercase tracking-wide text-slate-500"},[t("tr",null,[t("th",{class:"px-4 py-3"},"Couple"),t("th",{class:"px-4 py-3"},"Template"),t("th",{class:"px-4 py-3"},"Owner"),t("th",{class:"px-4 py-3"},"Date"),t("th",{class:"px-4 py-3"},"Published"),t("th",{class:"px-4 py-3"},"Link"),t("th",{class:"px-4 py-3 text-right"},"Actions")])],-1)),t("tbody",null,[(a(!0),o($,null,D(l.value,s=>{var d,f;return a(),o("tr",{key:s.id,class:"border-t last:border-b hover:bg-slate-50/60"},[t("td",j,[t("div",F,r(s.bride_name)+" & "+r(s.groom_name),1),t("div",I,r(s.title||"—"),1)]),t("td",N,r(((d=s.template)==null?void 0:d.name)||"—"),1),t("td",P,r(((f=s.user)==null?void 0:f.name)||"Superadmin only"),1),t("td",V,[s.date?(a(),o("span",B,r(k(s.date)),1)):(a(),o("span",O,"—"))]),t("td",R,[s.is_published?(a(),o("span",q," Published ")):(a(),o("span",M," Draft "))]),t("td",U,[t("div",K,r(s.slug),1),t("button",{class:"mt-1 text-[11px] text-rose-500 hover:text-rose-600",type:"button",onClick:x=>g(s)}," Copy link ",8,X)]),t("td",z,[t("div",G,[p?(a(),o("a",{key:0,href:h(s),target:"_blank",class:"rounded-full border border-slate-200 px-3 py-1 font-medium hover:bg-slate-50"}," Open ",8,H)):c("",!0),p?(a(),o("button",{key:1,class:"rounded-full bg-slate-900 px-3 py-1 font-medium text-white hover:bg-slate-800",type:"button",onClick:x=>e.$router.push({name:"invitations.edit",params:{id:s.id}})}," Edit ",8,J)):c("",!0),t("button",{class:"rounded-full border border-leaf-soft px-3 py-1 font-medium text-leaf-deep hover:bg-leaf-soft/20",type:"button",onClick:x=>e.$router.push({name:"invitations.rsvps",params:{id:s.id}})}," RSVP ",8,Q),p?(a(),o("button",{key:2,class:"rounded-full bg-red-500 px-3 py-1 font-medium text-white hover:bg-red-600",type:"button",onClick:x=>w(s)}," Delete ",8,W)):c("",!0)])])])}),128))])])])):(a(),o("div",E,' Пока нет ни одного приглашения. Создайте новое через вкладку "Templates". ')),i.value?(a(),o("p",Y,r(i.value),1)):c("",!0)]))}};export{et as default};
